<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenPayments - Tus Pagos en la palma de tu mano</title>



    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo h1 {
            color: #007bff;
            font-size: 1.8rem;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }

        nav a {
            text-decoration: none;
            color: #555;
            font-weight: 500;
            position: relative;
        }

        nav a.active {
            color: #007bff;
            font-weight: bold;
        }

        .user-actions {
            display: flex;
            gap: 10px;
        }

        button {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
        }

        .btn-primary {
            background-color: #007bff;
            color: white;
        }

        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }

        main {
            padding: 2rem;
        }

        .panel {
            display: none;
            animation: fadeIn 0.4s ease-in;
            padding: 2rem;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .welcome-banner {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
        }

        h2 {
            margin-bottom: 1rem;
            color: #333;
        }

        .accounts-container,
        .services-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 2rem;
        }

        .account-card,
        .service-item {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .account-balance .balance-amount {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 10px 0;
        }

        .positive {
            color: #28a745;
        }

        .negative {
            color: #dc3545;
        }

        .actions-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .action-btn,
        #open-payments-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: white;
            border: 2px solid #007bff;
            border-radius: 10px;
            width: 150px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .action-btn:hover,
        #open-payments-btn:hover {
            background: #007bff;
            color: white;
        }

        #open-payments-container {
            margin-top: 20px;
        }

        #open-payments-form {
            padding: 20px;
            border: 2px solid #007bff;
            border-radius: 10px;
            background: #f8f9fa;
        }

        #open-payments-form input,
        select {
            width: 100%;
            padding: 8px;
            margin: 5px 0 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        #open-payments-form button {
            width: 100%;
            padding: 10px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        #payment-status {
            margin-top: 15px;
            font-weight: bold;
            color: #555;
        }

        .transactions-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .transaction {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.05);
        }

        .transaction-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
        }

        .water {
            background: #17a2b8;
        }

        .electricity {
            background: #ffc107;
        }

        .internet {
            background: #28a745;
        }

        footer {
            background: #333;
            color: white;
            padding: 2rem;
            margin-top: 2rem;
        }

        .footer-links {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section a {
            color: #ccc;
            text-decoration: none;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 1rem;
            border-top: 1px solid #555;
        }

        .social-links a {
            color: white;
            margin: 0 10px;
            font-size: 1.2rem;
        }

        .back-btn {
            margin-bottom: 1rem;
            background: #6c757d;
        }
    </style>
</head>

<body>
    <header>
        <div class="logo">
            <i class="fas fa-wallet"></i>
            <h1>OpenPayments</h1>
        </div>
        <nav>
            <ul>
                <li><a href="#" id="home-nav-btn" class="active">Inicio</a></li>
                <li><a href="#" id="payments-nav-btn">Pagos</a></li>
                <li><a href="#" id="services-nav-btn">Servicios</a></li>
            </ul>
        </nav>
        <div class="user-actions">
            <button class="btn-secondary"><i class="fas fa-bell"></i></button>
            <button class="btn-primary" id="logout-btn">Salir</button>
        </div>
    </header>

    <!-- PANEL: PAGOS (HISTORIAL) -->
    <div id="payments-panel" class="panel">
        <button class="btn-secondary back-btn" onclick="goTo('home')">← Volver al Inicio</button>
        <h2>Historial de Pagos</h2>
        <div class="transactions-list" id="payments-history">
            <!-- Se llenará dinámicamente -->
        </div>
    </div>

    <!-- PANEL: SERVICIOS -->
    <div id="services-panel" class="panel">
        <button class="btn-secondary back-btn" onclick="goTo('home')">← Volver al Inicio</button>
        <h2>Servicios Disponibles</h2>
        <div class="services-list">
            <div class="service-item">
                <h3>Agua</h3>
                <p>Monto adeudado: $65.38</p>
                <p>Vence en 5 días</p>
                <button class="btn-primary pay-service-btn" data-service="Agua" data-amount="65.38">Pagar Ahora</button>
            </div>
            <div class="service-item">
                <h3>Luz</h3>
                <p>Monto adeudado: $94.20</p>
                <p>Vence en 3 días</p>
                <button class="btn-primary pay-service-btn" data-service="Luz" data-amount="94.20">Pagar Ahora</button>
            </div>
            <div class="service-item">
                <h3>Internet</h3>
                <p>Monto adeudado: $42.75</p>
                <p>Vence en 15 días</p>
                <button class="btn-primary pay-service-btn" data-service="Internet" data-amount="42.75">Pagar
                    Ahora</button>
            </div>
            <div class="service-item">
                <h3>Gas</h3>
                <p>Monto adeudado: $38.90</p>
                <p>Vence en 8 días</p>
                <button class="btn-primary pay-service-btn" data-service="Gas" data-amount="38.90">Pagar Ahora</button>
            </div>
        </div>
    </div>

    <!-- CONTENIDO PRINCIPAL (INICIO) -->
    <main id="main-content">
        <section class="welcome-banner">
            <div class="welcome-text">
                <h2>Bienvenido de nuevo, Jose Carlos</h2>
            </div>
        </section>

        <section class="Pagos-pendientes">
            <h2>Pagos pendientes</h2>
            <div class="accounts-container">
                <div class="account-card">
                    <div class="account-info">
                        <h3>Agua</h3>
                        <p class="account-number">Vence en 5 días</p>
                    </div>
                    <div class="account-balance">
                        <p class="balance-amount">$65.38</p>
                        <p class="balance-change negative">Pendiente</p>
                    </div>
                    <button class="btn-secondary pay-btn" data-service="Agua" data-amount="65.38">Pagar Ahora</button>
                </div>

                <div class="account-card">
                    <div class="account-info">
                        <h3>Luz</h3>
                        <p class="account-number">Vence en 3 días</p>
                    </div>
                    <div class="account-balance">
                        <p class="balance-amount">$94.20</p>
                        <p class="balance-change negative">Pendiente</p>
                    </div>
                    <button class="btn-secondary pay-btn" data-service="Luz" data-amount="94.20">Pagar Ahora</button>
                </div>

                <div class="account-card">
                    <div class="account-info">
                        <h3>Internet</h3>
                        <p class="account-number">Vence en 15 días</p>
                    </div>
                    <div class="account-balance">
                        <p class="balance-amount">$42.75</p>
                        <p class="balance-change negative">Pendiente</p>
                    </div>
                    <button class="btn-secondary pay-btn" data-service="Internet" data-amount="42.75">Pagar
                        Ahora</button>
                </div>
            </div>
        </section>

        <section class="quick-actions">
            <h2>Pagar</h2>
            <div class="actions-container">
                <button id="open-payments-btn">
                    <i class="fas fa-mobile-alt"></i>
                    <span>OpenPayments</span>
                </button>

                <div id="open-payments-container"></div>

                <button id="history-btn" class="action-btn">
                    <i class="fas fa-history"></i>
                    <span>Historial de pagos</span>
                </button>
            </div>
        </section>

        <section class="recent-transactions">
            <div class="section-header">
                <h2>Servicios Recientes</h2>
                <a href="#" class="view-all">Ver Todo</a>
            </div>
            <div class="transactions-list" id="transactions-list">
                <div class="transaction" data-service="Agua" data-amount="65.38">
                    <div class="transaction-icon water">
                        <i class="fa-solid fa-droplet"></i>
                    </div>
                    <div class="transaction-details">
                        <h3>Agua</h3>
                        <p class="transaction-date">Hoy, 9:30 AM</p>
                    </div>
                    <p class="transaction-amount negative">-$65.38</p>
                </div>
                <div class="transaction" data-service="Internet" data-amount="42.75">
                    <div class="transaction-icon internet">
                        <i class="fa-solid fa-wifi"></i>
                    </div>
                    <div class="transaction-details">
                        <h3>Internet</h3>
                        <p class="transaction-date">Lunes, 1:25 PM</p>
                    </div>
                    <p class="transaction-amount negative">-$42.75</p>
                </div>
                <div class="transaction" data-service="Electricidad" data-amount="94.20">
                    <div class="transaction-icon electricity">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <div class="transaction-details">
                        <h3>Electricidad</h3>
                        <p class="transaction-date">Jun 15, 10:00 AM</p>
                    </div>
                    <p class="transaction-amount negative">-$94.20</p>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-links">
            <div class="footer-section">
                <h3>Acerca de nosotros</h3>
                <ul>
                    <li><a href="#">Informacion de la compañia</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Soporte</h3>
                <ul>
                    <li><a href="#">Centro de ayuda</a></li>
                    <li><a href="#">Contactanos</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Legal</h3>
                <ul>
                    <li><a href="#">Politicas de privacidad</a></li>
                    <li><a href="#">Terminos del servicio</a></li>
                    <li><a href="#">Seguridad</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 OpenPayments.</p>
            <div class="social-links">
                <a href="#"><i class="fab fa-facebook"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
                <a href="#"><i class="fab fa-linkedin"></i></a>
            </div>
        </div>
    </footer>

    <script>
        function test(

        ) {
            const monto = document.getElementById('payment-amount').value
            const wallet = document.getElementById('receiver-address').value
            const datos = {
                monto: monto,
                wallet: wallet
            }
            console.log('DATA', datos)
          
            console.log("click")
            fetch(`http://localhost:3000/pago`, {
                method: "POST",
                body: JSON.stringify(datos),
                headers: { "Content-type": "application/json; charset=UTF-8" }
            })
                .then(Response => { return Response.json() })
                .then(data => { console.log(data) })
        }



        document.addEventListener("DOMContentLoaded", () => {
            // Elementos del DOM
            const homeNavBtn = document.getElementById("home-nav-btn");
            const paymentsNavBtn = document.getElementById("payments-nav-btn");
            const servicesNavBtn = document.getElementById("services-nav-btn");
            const logoutBtn = document.getElementById("logout-btn");
            const openPaymentsBtn = document.getElementById("open-payments-btn");
            const container = document.getElementById("open-payments-container");
            const historyBtn = document.getElementById("history-btn");
            const transactionsList = document.getElementById("transactions-list");
            const paymentsHistory = document.getElementById("payments-history");

            let isOpen = false;

            // Función para cambiar de panel
            function goTo(panel) {
                document.getElementById("main-content").style.display = "none";
                document.getElementById("payments-panel").style.display = "none";
                document.getElementById("services-panel").style.display = "none";

                [homeNavBtn, paymentsNavBtn, servicesNavBtn].forEach(btn => {
                    btn.classList.remove("active");
                });

                if (panel === 'home') {
                    document.getElementById("main-content").style.display = "block";
                    homeNavBtn.classList.add("active");
                } else if (panel === 'payments') {
                    document.getElementById("payments-panel").style.display = "block";
                    paymentsNavBtn.classList.add("active");
                    loadPaymentsHistory();
                } else if (panel === 'services') {
                    document.getElementById("services-panel").style.display = "block";
                    servicesNavBtn.classList.add("active");
                }
            }

            // Navegación
            homeNavBtn.addEventListener("click", (e) => { e.preventDefault(); goTo('home'); });
            paymentsNavBtn.addEventListener("click", (e) => { e.preventDefault(); goTo('payments'); });
            servicesNavBtn.addEventListener("click", (e) => { e.preventDefault(); goTo('services'); });

            // Logout
            logoutBtn.addEventListener("click", () => {
                if (confirm("¿Estás seguro que deseas cerrar sesión?")) {
                    alert("👋 Sesión cerrada. ¡Gracias por usar OpenPayments!");
                    location.reload();
                }
            });

            // Cargar historial
            function loadPaymentsHistory() {
                paymentsHistory.innerHTML = "";
                const transactions = document.querySelectorAll("#transactions-list .transaction");

                if (transactions.length === 0) {
                    paymentsHistory.innerHTML = "<p>No tienes pagos registrados aún.</p>";
                    return;
                }

                transactions.forEach(trans => {
                    const clone = trans.cloneNode(true);
                    paymentsHistory.appendChild(clone);
                });
            }

            // Pagar desde panel Servicios
            document.addEventListener("click", (e) => {
                if (e.target.classList.contains("pay-service-btn")) {
                    const service = e.target.dataset.service;
                    const amount = parseFloat(e.target.dataset.amount);
                    addTransactionToHistory(service, amount);
                    alert(`✅ Pago de $${amount} por ${service} realizado con éxito.`);
                }
            });

            // Obtener servicios recientes
            function getRecentServices() {
                const services = [];
                document.querySelectorAll("#transactions-list .transaction").forEach(el => {
                    const service = el.dataset.service;
                    const amount = el.dataset.amount;
                    if (service && !services.find(s => s.name === service)) {
                        services.push({ name: service, amount: amount });
                    }
                });
                return services;
            }

            // OpenPayments
            openPaymentsBtn.addEventListener("click", () => {
                if (isOpen) {
                    container.innerHTML = "";
                    isOpen = false;
                    return;
                }

                const services = getRecentServices();
                let optionsHtml = "";
                services.forEach(s => {
                    optionsHtml += `<option value="${s.name}">${s.name} - $${parseFloat(s.amount).toFixed(2)}</option>`;
                });

                container.innerHTML = `
                    <div id="open-payments-form">
                        <h3><i class="fas fa-wallet"></i> Pago con OpenPayments</h3>
                        <label>Servicio (basado en historial):</label>
                        <select id="service-select">
                            ${optionsHtml}
                            <option value="Otro" id="servicio">Otro servicio...</option>
                        </select>
                        <label>Monto ($):</label>
                        <input type="number" id="payment-amount" min="0.01" step="0.01" value="10.00">
                        <label>Wallet Address (receiver):</label>
                        <input type="text" id="receiver-address" value="ilp.interledger-test.dev/" >
                        <button id="initiate-payment" class="btn-primary" onclick="test();">Iniciar Pago</button>
                        <p id="payment-status"></p>
                    </div>

                    

                `;

                

                isOpen = true;

                const serviceSelect = document.getElementById("service-select");
                serviceSelect.addEventListener("change", () => {
                    const selected = services.find(s => s.name === serviceSelect.value);
                    if (selected) {
                        document.getElementById("payment-amount").value = selected.amount;
                    } else {
                        document.getElementById("payment-amount").value = "10.00";
                    }
                });

                document.getElementById("initiate-payment").addEventListener("click", handlePayment);
            });

            // Función de pago
            function handlePayment() {
                const amount = parseFloat(document.getElementById("payment-amount")?.value || 0);
                const service = document.getElementById("service-select")?.value || "Desconocido";
                const statusEl = document.getElementById("payment-status");

                if (!amount || amount <= 0) {
                    statusEl.textContent = "⚠️ Ingresa un monto válido.";
                    statusEl.style.color = "#ffc107";
                    return;
                }

                statusEl.textContent = "🔄 Procesando...";
                statusEl.style.color = "#007bff";

                setTimeout(() => {
                    const success = Math.random() > 0.1;
                    if (success) {
                        statusEl.textContent = `✅ ¡Pago de $${amount.toFixed(2)} por ${service} completado!`;
                        statusEl.style.color = "#28a745";
                        addTransactionToHistory(service, amount);
                    } else {
                        statusEl.textContent = "❌ Error: Pago fallido. Inténtalo de nuevo.";
                        statusEl.style.color = "#dc3545";
                    }
                }, 1200);
            }

            // Agregar transacción al historial
            function addTransactionToHistory(service, amount) {
                const now = new Date();
                const time = now.toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' });

                const iconMap = {
                    "Agua": { icon: "fa-droplet", class: "water" },
                    "Luz": { icon: "fa-bolt", class: "electricity" },
                    "Internet": { icon: "fa-wifi", class: "internet" },
                    "Electricidad": { icon: "fa-bolt", class: "electricity" },
                    "Gas": { icon: "fa-fire", class: "danger" }
                };

                const { icon, class: iconClass } = iconMap[service] || { icon: "fa-money-bill", class: "water" };

                const transaction = document.createElement("div");
                transaction.className = "transaction";
                transaction.dataset.service = service;
                transaction.dataset.amount = amount;
                transaction.innerHTML = `
                    <div class="transaction-icon ${iconClass}">
                        <i class="fa-solid ${icon}"></i>
                    </div>
                    <div class="transaction-details">
                        <h3>${service}</h3>
                        <p class="transaction-date">Hoy, ${time}</p>
                    </div>
                    <p class="transaction-amount negative">-$${amount.toFixed(2)}</p>
                `;

                transactionsList.prepend(transaction);
            }

            // Botones "Pagar Ahora" en inicio
            document.querySelectorAll(".pay-btn").forEach(btn => {
                btn.addEventListener("click", () => {
                    const service = btn.dataset.service;
                    const amount = parseFloat(btn.dataset.amount);
                    addTransactionToHistory(service, amount);
                    alert(`✅ Pago simulado de $${amount} por ${service} registrado.`);
                });
            });

            // Scroll a historial
            historyBtn.addEventListener("click", () => {
                transactionsList.scrollIntoView({ behavior: 'smooth' });
            });
        });
    </script>
</body>

</html>